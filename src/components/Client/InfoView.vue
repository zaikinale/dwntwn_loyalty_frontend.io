<template>
  <div class="card">
    <h3>–ê–¥—Ä–µ—Å–∞ –∫–æ—Ñ–µ–µ–Ω</h3>
    <div class="locations">
      <a
        href="https://yandex.ru/maps/-/CLRijYmL"
        target="_blank"
        rel="noopener noreferrer"
        class="location-link"
      >
        —É–ª. –ö–∞–∑–∞–Ω—Å–∫–∞—è, 25
      </a>
      <a
        href="https://yandex.ru/maps/-/CLRifK3C"
        target="_blank"
        rel="noopener noreferrer"
        class="location-link"
      >
        —É–ª. –ú–∞–ª–∞—è –ú–æ—Ä—Å–∫–∞—è, 18
      </a>
    </div>
  </div>

  <div class="card">
    <h3>–û—Å—Ç–∞–≤–∏—Ç—å —á–∞–µ–≤—ã–µ</h3>
    <a
      href="https://netmonet.co/qr/494339/groups/0?o=2"
      target="_blank"
      rel="noopener noreferrer"
      class="location-link"
    >
      c—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ—Ç–º–æ–Ω–µ—Ç
    </a>
  </div>

  <div class="card">
    <h3>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</h3>
    <a
      href="https://t.me/dwntwn_coffee_support_bot"
      target="_blank"
      rel="noopener noreferrer"
      class="support-link"
    >
      –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ Telegram!<br>
      @dwntwn_coffee_support_bot
    </a>
  </div>

  <div class="card">
    <h3>–ú—ã –≤ Instagram</h3>
    <a
      href="https://instagram.com/dwntwn_coffee"
      target="_blank"
      rel="noopener noreferrer"
      class="social-link"
    >
      @dwntwn_coffee
    </a>
  </div>
  <div class="card">
    <div class="card-head">
      <h3>–ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏</h3> 
      <button class="toggle-btn" @click="isRulesVisible = !isRulesVisible">
        {{ isRulesVisible ? '‚Üë' : '‚Üì' }}
      </button>
    </div>
  <div v-show="isRulesVisible" class="rules-content">
    <p><strong>1. –£—á–∞—Å—Ç–∏–µ</strong><br />–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º –≥–æ—Å—Ç—è–º –∫–æ—Ñ–µ–µ–Ω dwntwn. –î–ª—è —É—á–∞—Å—Ç–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram Mini App.</p>

    <p><strong>2. –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤</strong><br />–ë–æ–Ω—É—Å—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∑–∞ –∫–∞–∂–¥—É—é –æ–ø–ª–∞—á–µ–Ω–Ω—É—é –ø–æ–∫—É–ø–∫—É –≤ —Ä–∞–∑–º–µ—Ä–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—Ç —Å—É–º–º—ã —á–µ–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è –≤–∞—à–µ–π –∫–∞—Ä—Ç—ã:</p>
    <ul>
      <li>PLATINA ‚Äî 10%</li>
      <li>GOLD ‚Äî 7%</li>
      <li>SILVER ‚Äî 5%</li>
      <li>BRONZE ‚Äî 3%</li>
      <li>IRON ‚Äî 1%</li>
    </ul>
    <p>–ë–æ–Ω—É—Å—ã –æ–∫—Ä—É–≥–ª—è—é—Ç—Å—è –≤ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É –¥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞.</p>

    <p><strong>3. –ë–æ–Ω—É—Å—ã ‚â† –¥–µ–Ω—å–≥–∏</strong><br />–ë–æ–Ω—É—Å—ã –Ω–µ —è–≤–ª—è—é—Ç—Å—è –¥–µ–Ω—å–≥–∞–º–∏, –Ω–µ –ø–æ–¥–ª–µ–∂–∞—Ç –æ–±–º–µ–Ω—É –Ω–∞ —Ä—É–±–ª–∏, –Ω–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —Å–∫–∏–¥–∫–∞ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.</p>

    <p><strong>4. –û–±–º–µ–Ω –±–æ–Ω—É—Å–æ–≤</strong><br />–ë–æ–Ω—É—Å—ã –º–æ–∂–Ω–æ –æ–±–º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–æ–¥–∞—Ä–∫–∏ –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ ¬´–ü–æ–¥–∞—Ä–∫–∏¬ª. –ö–∞–∂–¥—ã–π –ø–æ–¥–∞—Ä–æ–∫ –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ –±–æ–Ω—É—Å–∞—Ö. –ü–æ—Å–ª–µ –æ–±–º–µ–Ω–∞ –±–æ–Ω—É—Å—ã —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å–æ —Å—á—ë—Ç–∞ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞.</p>

    <p><strong>5. –ê–∫—Ü–∏–∏ –∏ —Å–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</strong><br />–ê–∫—Ü–∏–∏, –ø—Ä–æ–º–æ–∫–æ–¥—ã –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è <strong>–Ω–µ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è</strong> –º–µ–∂–¥—É —Å–æ–±–æ–π. –ü—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∫–∏ –ø–æ –∞–∫—Ü–∏–∏ –∏–ª–∏ —Å–æ —Å–∫–∏–¥–∫–æ–π <strong>–±–æ–Ω—É—Å—ã –Ω–µ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è</strong>.</p>

    <p><strong>6. –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –±–æ–Ω—É—Å–æ–≤</strong><br />–ë–æ–Ω—É—Å—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤ —Å –¥–∞—Ç—ã –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è. –ü–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Å—Ä–æ–∫–∞ –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–Ω—É–ª–∏—Ä—É—é—Ç—Å—è.</p>

    <p><strong>7. –í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã</strong><br />–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–∫–∏–Ω—É—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç. –ü—Ä–∏ —ç—Ç–æ–º:</p>
    <ul>
      <li>–í—Å–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –∞–Ω–Ω—É–ª–∏—Ä—É—é—Ç—Å—è;</li>
      <li>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ –∏ –æ–±–º–µ–Ω–æ–≤ —É–¥–∞–ª—è–µ—Ç—Å—è;</li>
      <li>–í–∞—à–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π, –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è—é—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ü–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.</li>
    </ul>
    <p>–ü–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–Ω–æ–≤–∞ ‚Äî –º—ã –≤—Å–µ–≥–¥–∞ —Ä–∞–¥—ã –≤–∞–º!</p>

    <p><strong>8. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª</strong><br />–ú—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –∑–∞ —Å–æ–±–æ–π –ø—Ä–∞–≤–æ –∏–∑–º–µ–Ω—è—Ç—å —É—Å–ª–æ–≤–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø–∞—é—Ç –≤ —Å–∏–ª—É —á–µ—Ä–µ–∑ 10 –¥–Ω–µ–π –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ Telegram-–±–æ—Ç–µ @dwntwn_coffee_bot.</p>
  </div>
</div>

  <div class="card">
    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º</h3>
    <button class="leave-button" @click="leaveLoyaltyProgram">–ü–æ–∫–∏–Ω—É—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É</button>
  </div>
</template>


<script setup>
import { ref } from 'vue'

const isRulesVisible = ref(false)

const leaveLoyaltyProgram = async () => {
  const confirmed = confirm(
    '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–æ–∫–∏–Ω—É—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏?\n' +
    '–í—Å–µ –≤–∞—à–∏ –±–æ–Ω—É—Å—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã, –Ω–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–Ω–æ–≤–∞.'
  )
  if (!confirmed) return

  const initData = window.Telegram?.WebApp?.initData
  if (!initData) {
    alert('–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏.')
    return
  }

  try {
    const response = await fetch(`${window.API_BASE}/api/client/delete-account`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ initData })
    })

    const data = await response.json()

    if (response.ok) {
      // üí° –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è "–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"
      alert('–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏!\n–ú—ã –≤—Å–µ–≥–¥–∞ –±—É–¥–µ–º —Ä–∞–¥—ã –≤–∞–º —Å–Ω–æ–≤–∞!')
      window.location.reload()
    } else {
      alert('–û—à–∏–±–∫–∞: ' + (data.detail || '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç'))
    }
  } catch (err) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞:', err)
    alert('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.')
  }
}
</script>


<style scoped>
.card {
  background: #111;
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 20px;
  color: white;
}
.card-head h3, .card h3 {
  margin-bottom: 10px;
  color: white;
}
.card-head {
  width: 100%;
  display: flex;
  align-items: center;
  gap: 5px;
} 

.location-link,
.social-link,
.support-link {
  display: block;
  color: #4da6ff;
  text-decoration: none;
  margin-bottom: 8px;
  line-height: 1.4;
}
.location-link:last-child,
.social-link:last-child,
.support-link:last-child {
  margin-bottom: 0;
}
.location-link:hover,
.social-link:hover,
.support-link:hover {
  color: #1a8cff;
  text-decoration: underline;
}
.rules-text {
  line-height: 1.6;
  font-size: 14px;
  margin: 0;
  color: inherit;
}
.rules-content {
  font-size: 14px;
  line-height: 1.6;
  color: inherit;
}
.rules-content p {
  margin: 0 0 12px 0;
}
.rules-content ul {
  margin: 6px 0 12px 20px;
  padding-left: 0;
  list-style-type: disc;
}
.rules-content li {
  margin-bottom: 4px;
  line-height: 1.5;
}

.leave-button {
  background: #e53935;
  color: white;
  border: none;
  padding: 10px 16px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: background 0.2s;
  width: 100%;
  text-align: center;
}
.leave-button:hover {
  background: #c62828;
}
.toggle-btn {
  background: none;
  border: none;
  color: #4da6ff;
  font-size: 13px;
  cursor: pointer;
  padding: 6px 0;
  margin-bottom: 12px;
  text-align: left;
  font-weight: 500;
}
.toggle-btn:hover {
  color: #1a8cff;
}
.rules-content {
  font-size: 14px;
  line-height: 1.6;
  color: inherit;
}
.rules-content p {
  margin: 0 0 12px 0;
}
.rules-content ul {
  margin: 6px 0 12px 20px;
  padding-left: 0;
  list-style-type: disc;
}
.rules-content li {
  margin-bottom: 4px;
  line-height: 1.5;
}
</style>